<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Staff Dashboard - GASC Sendamangalam</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Segoe UI', Arial, sans-serif; background: #f5f5f5; }
    
    /* Header */
    .dashboard-header {
      background: linear-gradient(135deg, #004080, #002050);
      color: white;
      padding: 20px 40px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    .dashboard-header h1 {
      font-size: 1.8rem;
    }
    .staff-info {
      display: flex;
      align-items: center;
      gap: 15px;
    }
    .staff-avatar {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      border: 2px solid #ffcc00;
    }
    .staff-details h3 {
      font-size: 1rem;
      margin-bottom: 3px;
    }
    .staff-details p {
      font-size: 0.85rem;
      color: #ffcc00;
    }
    .logout-button {
      background: #dc3545;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.3s;
    }
    .logout-button:hover {
      background: #c82333;
      transform: translateY(-2px);
    }

    /* Container */
    .container {
      max-width: 1400px;
      margin: 30px auto;
      padding: 0 20px;
    }

    /* Stats Cards */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    .stat-card {
      background: white;
      padding: 25px;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      display: flex;
      align-items: center;
      gap: 20px;
    }
    .stat-icon {
      font-size: 3rem;
    }
    .stat-info h3 {
      color: #004080;
      font-size: 2rem;
      margin-bottom: 5px;
    }
    .stat-info p {
      color: #666;
      font-size: 0.9rem;
    }

    /* Students Table */
    .table-container {
      background: white;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      padding: 30px;
    }
    .table-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    .table-header h2 {
      color: #004080;
      font-size: 1.5rem;
    }
    .search-box {
      padding: 10px 15px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 14px;
      width: 300px;
      transition: border-color 0.3s;
    }
    .search-box:focus {
      outline: none;
      border-color: #004080;
    }

    /* Table */
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    thead {
      background: linear-gradient(135deg, #004080, #002050);
      color: white;
    }
    th {
      padding: 15px;
      text-align: left;
      font-weight: 600;
      font-size: 14px;
    }
    td {
      padding: 15px;
      border-bottom: 1px solid #e0e0e0;
      font-size: 14px;
    }
    tbody tr {
      transition: background 0.3s;
    }
    tbody tr:hover {
      background: #f8f9fa;
    }
    .student-photo {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      border: 2px solid #004080;
    }
    .edit-btn, .save-btn, .delete-btn {
      padding: 6px 12px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 12px;
      margin-right: 5px;
      transition: all 0.3s;
    }
    .edit-btn {
      background: #ffc107;
      color: #333;
    }
    .edit-btn:hover {
      background: #ffb300;
    }
    .save-btn {
      background: #28a745;
      color: white;
    }
    .save-btn:hover {
      background: #218838;
    }
    .delete-btn {
      background: #dc3545;
      color: white;
    }
    .delete-btn:hover {
      background: #c82333;
    }
    .editable-input {
      padding: 6px;
      border: 2px solid #004080;
      border-radius: 4px;
      font-size: 13px;
      width: 100%;
    }

    /* Add Student Button */
    .add-student-btn {
      background: linear-gradient(135deg, #28a745, #20c997);
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      transition: all 0.3s;
    }
    .add-student-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(40, 167, 69, 0.3);
    }

    /* Loading */
    .loading {
      text-align: center;
      padding: 40px;
      color: #666;
    }
  </style>
</head>
<body>
  <!-- Header -->
  <div class="dashboard-header">
    <h1>üë®‚Äçüè´ Staff Dashboard</h1>
    <div style="display: flex; align-items: center; gap: 30px;">
      <div class="staff-info">
        <img id="staffAvatar" class="staff-avatar" src="" alt="Staff">
        <div class="staff-details">
          <h3 id="staffName">Loading...</h3>
          <p id="staffDesignation">...</p>
        </div>
      </div>
      <button class="logout-button" onclick="logout()">üö™ Logout</button>
    </div>
  </div>

  <!-- Container -->
  <div class="container">
    <!-- Stats Cards -->
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-icon">üéì</div>
        <div class="stat-info">
          <h3 id="totalStudents">0</h3>
          <p>Total Students</p>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon">üë®‚Äçüíº</div>
        <div class="stat-info">
          <h3>5+</h3>
          <p>Faculty Members</p>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon">üíª</div>
        <div class="stat-info">
          <h3>2</h3>
          <p>Computer Labs</p>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon">üìö</div>
        <div class="stat-info">
          <h3>2023-2026</h3>
          <p>Current Batch</p>
        </div>
      </div>
    </div>

    <!-- Students Table -->
    <div class="table-container">
      <div class="table-header">
        <h2>üìã Students Database</h2>
        <div>
          <input type="text" id="searchBox" class="search-box" placeholder="üîç Search by name or roll number..." onkeyup="searchStudents()">
        </div>
      </div>

      <table id="studentsTable">
        <thead>
          <tr>
            <th>Photo</th>
            <th>Roll Number</th>
            <th>Name</th>
            <th>Email</th>
            <th>Course</th>
            <th>Year</th>
            <th>Batch</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="studentsTableBody">
          <tr>
            <td colspan="8" class="loading">Loading students data...</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <script>
    // Get staff data from localStorage
    const staffData = JSON.parse(localStorage.getItem('staffData') || '{}');
    
    if (!staffData.id) {
      alert('Unauthorized access! Please login first.');
      window.location.href = 'index.html';
    }

    // Display staff info
    document.getElementById('staffAvatar').src = staffData.photo || '';
    document.getElementById('staffName').textContent = staffData.name || 'Staff';
    document.getElementById('staffDesignation').textContent = staffData.designation || 'Faculty';

    // Student Database
    const studentNames = [
      'Arun Kumar', 'Bala Murugan', 'Chandru Raj', 'Deepak Kumar', 'Ezhil Arasan',
      'Farhan Ali', 'Gokul Raj', 'Hari Krishnan', 'Inba Raj', 'Jaya Kumar',
      'Karthik Raja', 'Lakshmi Priya', 'Manoj Kumar', 'Naveen Raj', 'Oviya Devi',
      'Priya Dharshini', 'Ranjith Kumar', 'Santhosh Kumar', 'Tamilselvan', 'Uma Maheshwari'
    ];

    let students = {};
    for (let i = 1; i <= 20; i++) {
      const rollNo = 'C23UG202CSC' + String(i).padStart(3, '0');
      students[rollNo] = {
        name: studentNames[i-1],
        photo: 'https://api.dicebear.com/7.x/avataaars/svg?seed=' + rollNo,
        email: rollNo.toLowerCase() + '@gasc.edu.in',
        course: 'B.Sc. Computer Science',
        year: 'I Year',
        batch: '2023-2026'
      };
    }

    // Update total students count
    document.getElementById('totalStudents').textContent = Object.keys(students).length;

    // Render students table
    function renderStudents(searchTerm = '') {
      const tbody = document.getElementById('studentsTableBody');
      tbody.innerHTML = '';

      const filteredStudents = Object.entries(students).filter(([rollNo, student]) => {
        if (!searchTerm) return true;
        const search = searchTerm.toLowerCase();
        return rollNo.toLowerCase().includes(search) || 
               student.name.toLowerCase().includes(search);
      });

      if (filteredStudents.length === 0) {
        tbody.innerHTML = '<tr><td colspan="8" style="text-align:center; padding:40px; color:#999;">No students found</td></tr>';
        return;
      }

      filteredStudents.forEach(([rollNo, student]) => {
        const row = document.createElement('tr');
        row.id = 'row-' + rollNo;
        row.innerHTML = `
          <td><img src="${student.photo}" class="student-photo" alt="${student.name}"></td>
          <td class="roll-no">${rollNo}</td>
          <td class="name">${student.name}</td>
          <td class="email">${student.email}</td>
          <td class="course">${student.course}</td>
          <td class="year">${student.year}</td>
          <td class="batch">${student.batch}</td>
          <td>
            <button class="edit-btn" onclick="editStudent('${rollNo}')">‚úèÔ∏è Edit</button>
            <button class="delete-btn" onclick="deleteStudent('${rollNo}')">üóëÔ∏è Delete</button>
          </td>
        `;
        tbody.appendChild(row);
      });
    }

    // Initial render
    renderStudents();

    // Search function
    function searchStudents() {
      const searchTerm = document.getElementById('searchBox').value;
      renderStudents(searchTerm);
    }

    // Edit student
    function editStudent(rollNo) {
      const row = document.getElementById('row-' + rollNo);
      const student = students[rollNo];

      row.innerHTML = `
        <td><img src="${student.photo}" class="student-photo" alt="${student.name}"></td>
        <td class="roll-no">${rollNo}</td>
        <td><input type="text" class="editable-input" id="edit-name-${rollNo}" value="${student.name}"></td>
        <td><input type="email" class="editable-input" id="edit-email-${rollNo}" value="${student.email}"></td>
        <td><input type="text" class="editable-input" id="edit-course-${rollNo}" value="${student.course}"></td>
        <td><input type="text" class="editable-input" id="edit-year-${rollNo}" value="${student.year}"></td>
        <td><input type="text" class="editable-input" id="edit-batch-${rollNo}" value="${student.batch}"></td>
        <td>
          <button class="save-btn" onclick="saveStudent('${rollNo}')">üíæ Save</button>
          <button class="delete-btn" onclick="cancelEdit()">‚ùå Cancel</button>
        </td>
      `;
    }

    // Save student
    function saveStudent(rollNo) {
      const name = document.getElementById('edit-name-' + rollNo).value.trim();
      const email = document.getElementById('edit-email-' + rollNo).value.trim();
      const course = document.getElementById('edit-course-' + rollNo).value.trim();
      const year = document.getElementById('edit-year-' + rollNo).value.trim();
      const batch = document.getElementById('edit-batch-' + rollNo).value.trim();

      if (!name || !email) {
        alert('Name and Email are required!');
        return;
      }

      students[rollNo].name = name;
      students[rollNo].email = email;
      students[rollNo].course = course;
      students[rollNo].year = year;
      students[rollNo].batch = batch;

      renderStudents(document.getElementById('searchBox').value);
      alert('Student data updated successfully!');
    }

    // Cancel edit
    function cancelEdit() {
      renderStudents(document.getElementById('searchBox').value);
    }

    // Delete student
    function deleteStudent(rollNo) {
      if (confirm('Are you sure you want to delete ' + students[rollNo].name + '?')) {
        delete students[rollNo];
        document.getElementById('totalStudents').textContent = Object.keys(students).length;
        renderStudents(document.getElementById('searchBox').value);
        alert('Student deleted successfully!');
      }
    }

    // Logout
    function logout() {
      if (confirm('Are you sure you want to logout?')) {
        localStorage.removeItem('staffData');
        window.location.href = 'index.html';
      }
    }
  </script>
</body>
</html>
